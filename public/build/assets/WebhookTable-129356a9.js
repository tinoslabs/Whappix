import{T as x,r as m,c as d,f as o,g as n,u as a,j as z,F as p,o as u,k as g,t as i,e as _,i as k,a as e,b as D,n as h,h as C}from"./app-a39c937f.js";import"./_baseGetTag-fe27dbe8.js";import{_ as H}from"./AlertModal-3dc931bd.js";import{u as q}from"./useAlertModal-0cf952b8.js";/* empty css              */import{_ as G}from"./FormCheckbox-f7d4efc1.js";import{_ as I}from"./FormInput-4b7fa008.js";import{_ as B}from"./Modal-df1e3aae.js";import{_ as J}from"./Table-7daa1325.js";import{T as K,a as P,_ as T}from"./TableHeaderRowItem-2700d168.js";import{T as Q,_ as V,a as X}from"./TableBodyRowItem-ed031f61.js";import{_ as Y}from"./Dropdown-3f09e41f.js";import{_ as ee,a as M}from"./DropdownItem-de9e1f1f.js";import"./transition-37a067aa.js";import"./hidden-695af094.js";import"./use-text-value-d1d229e7.js";import"./micro-task-89dcd6af.js";import"./Pagination-10a3ee54.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./use-tree-walker-d82ec41e.js";const te={class:"flex"},se={class:"text-left mr-3 text-sm relative w-[10em] truncate"},le={class:"py-1 px-2 bg-gray-50 rounded-[5px] border border-dashed w-[20em] truncate text-xs capitalize"},oe={class:"flex items-center"},ne=["onClick"],re={class:"mt-5 grid grid-cols-1 gap-x-6"},ae={class:"mt-4 text-sm"},ie={class:"mt-4 flex"},ue=["disabled"],de={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},me={key:1},fe={class:"mt-5 grid grid-cols-1 gap-x-6"},pe={class:"text-sm bg-slate-100 py-1 rounded-md px-2"},ce={class:"mt-4"},be={class:"flex items-center justify-between border-b py-1 text-sm"},ve={class:"capitalize"},ge=["onClick"],_e={class:"grid gap-x-6 sm:grid-cols-6"},he={class:"mt-4 flex"},Ze={__name:"WebhookTable",props:{rows:{type:Object,required:!0},events:{type:Object}},emits:["delete"],setup(w,{emit:we}){const A=w,{isOpenAlert:y,openAlert:E,confirmAlert:N}=q(),S=x({test:null});m(null),m(null);const c=m(!1),$=m(!1),O=m(null),R=s=>{S.delete("/developer-tools/webhooks/"+s)},U=s=>s===A.rows.data.length-1,r=x({url:null,events:[]}),F=s=>{r.url=s.url,r.events=s.events.map(t=>t.event),c.value=!0},L=s=>{r.url=s.url,r.events=s.events.map(t=>t.event),$.value=!0},j=x({url:null}),b=m(null),W=(s,t)=>{j.url=s,b.value=t,j.post(`/webhooks/trigger/${t}/test`,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{b.value=null},onError:()=>{b.value=null}})},Z=async()=>{r.post("/developer-tools/webhooks/"+O.value,{preserveScroll:!0,preserveState:!1,onSuccess:()=>{c.value=!1}})};return(s,t)=>(u(),d(p,null,[o(J,{rows:w.rows},{default:n(()=>[o(K,null,{default:n(()=>[o(P,null,{default:n(()=>[o(T,{position:"first"},{default:n(()=>[g(i(s.$t("Notification URL")),1)]),_:1}),o(T,null,{default:n(()=>[g(i(s.$t("Events")),1)]),_:1}),o(T,{position:"last"})]),_:1})]),_:1}),o(Q,null,{default:n(()=>[(u(!0),d(p,null,_(w.rows.data,(l,f)=>(u(),k(X,{key:f,class:h(U(f)?"":"border-b")},{default:n(()=>[o(V,{position:"first"},{default:n(()=>[e("div",te,[e("div",se,[e("span",null,i(l.url),1)])])]),_:2},1024),o(V,{class:"hidden sm:table-cell"},{default:n(()=>[e("div",le,[(u(!0),d(p,null,_(l.events,v=>(u(),d("span",null,i(v.event)+", ",1))),256))])]),_:2},1024),o(V,{position:"last"},{default:n(()=>[e("div",oe,[e("button",{onClick:v=>L(l),class:"bg-slate-100 border rounded-md py-1 px-4 h-[fit-content]"},"Test",8,ne),l.role!="admin"?(u(),k(Y,{key:0,align:"right",class:"mt-2"},{items:n(()=>[o(ee,null,{default:n(()=>[o(M,{as:"button",onClick:v=>{F(l),O.value=l.uuid}},{default:n(()=>[g(i(s.$t("View/edit")),1)]),_:2},1032,["onClick"]),o(M,{as:"button",onClick:v=>a(E)(l.uuid)},{default:n(()=>[g(i(s.$t("Delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:n(()=>[t[7]||(t[7]=e("button",{class:"inline-flex w-full justify-center rounded-md text-sm font-medium text-black hover:bg-opacity-30 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75"},[e("span",{class:"hover:bg-[#F6F7F9] hover:rounded-full w-[fit-content] p-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 16a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2m0-6a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2m0-6a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2Z"})])])],-1))]),_:2},1024)):D("",!0)])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1},8,["rows"]),o(B,{label:s.$t("Edit/View Webhook"),isOpen:c.value},{default:n(()=>[e("div",re,[e("form",{onSubmit:t[3]||(t[3]=C(l=>Z(),["prevent"])),class:"grid gap-x-6 sm:grid-cols-6"},[o(I,{modelValue:a(r).url,"onUpdate:modelValue":t[0]||(t[0]=l=>a(r).url=l),error:a(r).errors.url,name:s.$t("URL"),type:"text",class:h("sm:col-span-6")},null,8,["modelValue","error","name"]),e("h4",ae,i(s.$t("Events")),1),(u(!0),d(p,null,_(A.events,l=>(u(),k(G,{key:l,modelValue:a(r).events,"onUpdate:modelValue":t[1]||(t[1]=f=>a(r).events=f),error:a(r).errors.events,name:s.$t(l),label:s.$t(l),value:l,type:"text",class:h("sm:col-span-6")},null,8,["modelValue","error","name","label","value"]))),128)),e("div",ie,[e("button",{type:"button",onClick:t[2]||(t[2]=C(l=>c.value=!1,["self"])),class:"inline-flex justify-center rounded-md border border-transparent bg-slate-50 px-4 py-2 text-sm text-slate-500 hover:bg-slate-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 mr-4"},i(s.$t("Cancel")),1),e("button",{class:h(["inline-flex justify-center rounded-md border border-transparent bg-primary px-4 py-2 text-sm text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",{"opacity-50":a(S).processing}]),disabled:a(r).processing},[a(r).processing?(u(),d("svg",de,t[8]||(t[8]=[e("path",{fill:"currentColor",d:"M12 2A10 10 0 1 0 22 12A10 10 0 0 0 12 2Zm0 18a8 8 0 1 1 8-8A8 8 0 0 1 12 20Z",opacity:".5"},null,-1),e("path",{fill:"currentColor",d:"M20 12h2A10 10 0 0 0 12 2V4A8 8 0 0 1 20 12Z"},[e("animateTransform",{attributeName:"transform",dur:"1s",from:"0 12 12",repeatCount:"indefinite",to:"360 12 12",type:"rotate"})],-1)]))):(u(),d("span",me,i(s.$t("Save")),1))],10,ue)])],32)])]),_:1},8,["label","isOpen"]),o(B,{label:s.$t("Test Webhook Notifications"),isOpen:$.value},{default:n(()=>[e("div",fe,[e("div",null,[t[9]||(t[9]=e("h4",{class:"mb-2"},"Webhook URL",-1)),e("h5",pe,i(a(r).url),1)]),e("div",ce,[t[10]||(t[10]=e("h4",{class:"mb-2"},"Events",-1)),(u(!0),d(p,null,_(a(r).events,l=>(u(),d("div",null,[e("div",be,[e("div",null,[e("span",ve,i(l),1)]),e("div",null,[e("button",{onClick:f=>W(a(r).url,l),class:"bg-slate-100 border rounded-md py-1 px-4 h-[fit-content]"},i(b.value===l?"Sending...":"Test"),9,ge)])])]))),256))]),e("div",_e,[e("div",he,[e("button",{type:"button",onClick:t[4]||(t[4]=C(l=>$.value=!1,["self"])),class:"inline-flex justify-center rounded-md border border-transparent bg-slate-50 px-4 py-2 text-sm text-slate-500 hover:bg-slate-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 mr-4"},i(s.$t("Cancel")),1)])])])]),_:1},8,["label","isOpen"]),o(H,{modelValue:a(y),"onUpdate:modelValue":t[5]||(t[5]=l=>z(y)?y.value=l:null),onConfirm:t[6]||(t[6]=()=>a(N)(R)),label:s.$t("Delete row"),description:s.$t("Are you sure you want to delete this row? This action can not be undone")},null,8,["modelValue","label","description"])],64))}};export{Ze as default};
